function u = linearize(x,v)
    C = @(x) cos(x);
    S = @(x) sin(x);
    T = @(x) tan(x);
    
    d = 2.4e-3;
g = 9.81;
m = 1.79;            % kg
Ixx = 1.335e-2;      % kg m^-2
Iyy = 1.335e-2;      % kg m^-2
Izz = 2.465e-2;      % kg m^-2
l = 0.18;            % m
Kt = 8.82;           % N rad^-2 s^2
Kd = 1.09e-2;        % N m rad^-2 s^2

    alpha = zeros(3,1);
    alpha(1) = -2*l*Izz*Kd^2*(Ixx*(-.25*C(x(2))^(-2)*Izz*(2*d^2*g^2*m^2*(S(2*x(1))+x(1)+C(2*x(1))*(-4*S(x(1))+x(1))-S(2*x(2))*x(2)*T(x(1)))+ ...
        2*d*g*m*Kd*(-3*x(4)-4*C(2*x(2))*S(x(1))*x(5)+C(x(1))^(-1)*(2*x(4)-C(3*x(1))*x(4)+2*C(2*x(1))*C(2*x(2))*x(4)+S(3*x(1))*x(5))+(2*S(2*x(2))*x(3)+x(5))*T(x(1)))+ ...
        Kd^2*(-6*x(4)*x(5)-C(3*x(1))^(-1)*(2*S(2*x(2))*x(3)*x(4)+2*C(3*x(1))*x(4)*x(5)+S(3*x(1))*(x(4)-x(5))*(x(4)+x(5)))+ ...
        (x(5)^2-3*x(4)^2+2*C(2*x(2))*x(4)^2)*T(x(1)))-C(x(1))^(-1)*Kd^3*x(5)*T(x(2)))+Izz*(Kd^2*(C(x(1))^(-1)*Kd*x(5)*T(x(2))-d*g*m*(x(2)+C(x(1))^(-1)*...
        (-1+S(x(1))*x(1))*T(x(1))))) + Izz*(-Kd^2*x(4)*x(5)+d*g*m*Kd*(-x(4)+C(x(1))*x(4)-S(x(1))*x(5)+x(3)*T(x(1))*T(x(2))+S(x(1))*(x(5)+x(4)*T(x(1)))*T(x(2))^2))+...
        d^2*g^2*m^2*(x(1)-x(2)*T(x(1))*T(x(2)) + S(x(1))*(-1+T(x(2))^2))));

    alpha(2) = Izz*Kd^2*(Ixx*(-Kd^3*x(5)*T(x(1))+ Izz*(d^2*g^2*m^2*(C(x(1))^(-1)*x(2)+(-2+C(x(1)))*T(x(2)))+Kd^2*(2*x(5)+x(4)*T(x(1))+ ...
        C(x(1))^(-1)*(S(x(1))*x(4)+C(x(1))*x(5))^2*T(x(2)))+2*d*g*m*Kd*(x(3)-C(x(1))^(-1)*x(3)+(S(x(1))*x(4)-x(5)+C(x(1))*x(5)-x(4)*T(x(1)))*T(x(2))))+ ...
           Izz*(C(x(1))^(-1)*Kd^2*(d*g*m*(S(x(1))*x(1))+S(x(1))*Kd*x(5))+Izz*(-Kd^2*x(3)*x(5)+d^2*g^2*m^2*(-C(x(1))^(-1)*x(2)+T(x(2)))+ ...
            d*g*m*Kd*((-1+C(x(1))^(-1)*x(3)+(x(5)+x(4)*T(x(1)))*T(x(2))))))));

    beta = [1   -(2*T(x(1))*T(x(2)))/l -(2*C(x(1))^(-1)*Ixx*T(x(2)))/(l*Izz);
            0   S(C(x(1)))              (Ixx*T(x(1)))/Izz;
            0   0                               1];

    u = alpha + beta * v
end